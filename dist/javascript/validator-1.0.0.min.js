!function(e){"function"==typeof define&&define.amd?define(["Zepto"],function(t){e(t)}):"function"==typeof define&&define.cmd?define(["Zepto"],function(t,n,i){e(t("Zepto"))}):e(Zepto)}(function(e){"use strict";var t=function(e,t){var n="undefined"!==e&&""!==e?e+",":"";return n+t},n=['input:not([type]),input[type="color"],input[type="date"],input[type="datetime"],input[type="datetime-local"],input[type="email"],input[type="file"],input[type="hidden"],input[type="month"],input[type="number"],input[type="password"],input[type="range"],input[type="search"],input[type="tel"],input[type="text"],input[type="time"],input[type="url"],input[type="week"],textarea',"select",'input[type="checkbox"],input[type="radio"]'],i=n.join(","),r=function(t,n){var o=t.find(i),n=e.extend(!0,r.defaults,n),u=this;this.$form=t,this.$fields=o,this.settings=n,o.each(function(){var t=e(this);t.is(i)&&e(this).on("change",function(e){u.checkFiled(t,n)})}),t.on("submit",function(i){var r=!0;n.isFirstTime=!0,o.each(function(){var t=e(this),i=u.checkFiled(t,n);i||(r=!1)}),r?n.valid.call(t,n):n.invalid.call(t,n),i.preventDefault(),i.stopImmediatePropagation()})};r.defaults={valid:e.noop,invalid:e.noop},r.rules={required:function(e){return""!==e},unique:function(e){},money:function(e){},key:function(e){var t=/^[a-zA-Z0-9_]+$/;return t.test(e)},shxydm:function(e){var t=/^[a-zA-Z0-9]{2}[0-9]{6}[a-zA-Z0-9]{10}$/;return t.test(e)},telephone:function(e){var t=/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/;return t.test(e)},mobile:function(e){var t=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return t.test(e)},email:function(e){var t=/([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)/;return t.test(e)},url:function(e){var t=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?/;return t.test(e)},postcode:function(e){var t=/^[1-9][0-9]{5}$/;return t.test(e)},idcard:function(e){var t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return t.test(e)},zmhsz:function(e){var t=/(^[A-Za-z]{1,}$)|(^[0-9]{1,}$)/;return t.test(e)},zw:function(e){var t=/[\u4e00-\u9fa5]/;return t.test(e)},zm:function(e){var t=/^[A-Za-z]+$/;return t.test(e)},n:function(e){var t=/^-?[1-9]\d*$/;return t.test(e)},zss:function(e){var t=/^[1-9]\d*$/;return t.test(e)},fss:function(e){var t=/^-[1-9]\d*$/;return t.test(e)},min:function(e,t){return e.length<t}},r.messages={required:"该项为必填/必选",unique:"必须唯一值",money:"请输入金额",key:"请输入关键字",shxydm:"请输入有效的社会信用代码",telephone:"请输入有效的电话号码",mobile:"请输入有效的手机号码",email:"请输入有效的E-mail",url:"请输入有效的网址",postcode:"邮编必须是5位数字",idcard:"请输入有效的身份证",zmhsz:"请输入字母或数字",zw:"请输入中文",zm:"请输入英文",n:"请输入整数",zss:"请输入正整数",fss:"请输入负整数"},r.prototype={checkForm:function(){var t=this,n=!0;return t.settings.isFirstTime=!0,t.$fields.each(function(){var i=e(this),r=t.checkFiled(i,t.settings);r||(n=!1)}),n},checkFiled:function(i,o){var u,s=!0,a=this,d=e.trim(i.val())||"",f=i.attr("data-rules"),c=i.attr("data-descriptions");if("undefined"!==f&&"undefined"!=typeof f&&""!==f&&null!==f&&"null"!=typeof f){var p=f.split(";"),l=p.indexOf("required")>=0;if(!l&&""===d)return s;for(var m=0,h=p.length;m<h;m++){var v=p[m];if(""!==v){if("required"===v&&i.is(n[2]))s=0!=a.$form.find('[name="'+i.prop("name")+'"]:checked').length;else if("required"===v&&i.is(n[1]))""!==d&&"请选择"!==d||(s=!1);else{if("undefined"==typeof r.rules[v])return s=!0,console.error("没有匹配到规则"+v),s;s=r.rules[v](d,i)}if(u=r.messages[v],a.borderColor(i,s),!s)return o.isFirstTime&&(a.showMsg(t(c,u)),i.focus()),o.isFirstTime=!1,s}}}return s},showMsg:function(t){e.toast(t)},borderColor:function(e,t){if("radio"==e.prop("type")||"checkbox"==e.prop("type")){var n=this.$form.find('[name="'+e.prop("name")+'"]'),i=n.next(".item-media").find(".icon");n.filter(":checked").length>0?i.removeClass("color-error"):i.addClass("color-error")}else t?e.removeClass("color-error"):e.addClass("color-error")}},e.fn.mdvalidate=function(t){var n=e(this),i=n.data("validator");if(i)return i;var o=new r(n,t);return n.data("validator",o),o},e.extend(e,{mdvalidateExtend:function(t){e.extend(r.rules,t.rules),e.extend(r.messages,t.messages)}})});